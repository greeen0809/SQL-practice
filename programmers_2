# 사분위수 계산은 NTILE(4) over (order by ~) 윈도우 함수!
# 형식 꼼꼼히 확인 -> 문자열 칼럼이면 따옴표로 지정하기
with ntile_t as 
(
    select *
          ,NTILE(4) OVER (order by SIZE_OF_COLONY) AS QUART
    from ecoli_data
)
SELECT ID
     , CASE WHEN QUART = 1 THEN 'LOW'
            WHEN QUART = 2 THEN 'MEDIUM'
            WHEN QUART = 3 THEN 'HIGH'
            WHEN QUART = 4 THEN 'CRITICAL'
        END
        AS COLONY_NAME
FROM  NTILE_T
ORDER BY ID
