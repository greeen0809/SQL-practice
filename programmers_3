with fish_info_1 as (
    select ID
         , fish_type
         , case when length <= 10 then 10 else length end as length_new
    from fish_info
) , fish_info_2 as (
    select count(ID) as fish_count
         , avg(length_new) as avg_length
         , max(length_new) as max_length
         , fish_type
    from fish_info_1
    group by fish_type
    )
select fish_count
         , max_length
         , fish_type
    from fish_info_2
    where avg_length >= 33
